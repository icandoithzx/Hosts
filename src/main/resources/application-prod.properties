# 生产环境配置
spring.profiles.active=prod

# 应用名称
spring.application.name=hosts-management-prod

# 服务器端口
server.port=8080

# 日志配置
logging.config=classpath:logback-spring.xml
logging.level.com.example.demo=WARN
logging.level.org.springframework=ERROR
logging.level.com.baomidou.mybatisplus=ERROR

# 数据库配置 - MariaDB（生产环境）
spring.datasource.url=jdbc:mariadb://prod-db-server:3306/hosts_management?useUnicode=true&characterEncoding=utf8&useSSL=true&serverTimezone=Asia/Shanghai
spring.datasource.driverClassName=org.mariadb.jdbc.Driver
spring.datasource.username=${DB_USERNAME:hosts_user}
spring.datasource.password=${DB_PASSWORD:your_secure_password}

# 数据库连接池配置 - 高并发生产环境优化
spring.datasource.hikari.minimum-idle=15
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.connection-timeout=15000
spring.datasource.hikari.validation-timeout=8000
spring.datasource.hikari.leak-detection-threshold=90000
spring.datasource.hikari.connection-test-query=SELECT 1

# 数据库性能优化配置
spring.datasource.hikari.cache-prep-stmts=true
spring.datasource.hikari.prep-stmt-cache-size=500
spring.datasource.hikari.prep-stmt-cache-sql-limit=2048
spring.datasource.hikari.use-server-prep-stmts=true
spring.datasource.hikari.use-local-session-state=true
spring.datasource.hikari.rewrite-batched-statements=true
spring.datasource.hikari.cache-result-set-metadata=true
spring.datasource.hikari.cache-server-configuration=true
spring.datasource.hikari.elide-set-auto-commits=true
spring.datasource.hikari.maintain-time-stats=false

# 连接验证和健康检查
spring.datasource.hikari.keepalive-time=300000
spring.datasource.hikari.allow-pool-suspension=false
spring.datasource.hikari.read-only=false
spring.datasource.hikari.register-mbeans=true

# H2控制台禁用（生产环境安全）
spring.h2.console.enabled=false

# Redis配置
spring.redis.host=${REDIS_HOST:prod-redis-server}
spring.redis.port=${REDIS_PORT:6379}
spring.redis.password=${REDIS_PASSWORD:your_redis_password}
spring.redis.timeout=5000ms
spring.redis.jedis.pool.max-active=50
spring.redis.jedis.pool.max-idle=20
spring.redis.jedis.pool.min-idle=5
spring.redis.jedis.pool.max-wait=3000ms

# 数据库初始化（生产环境谨慎使用）
spring.sql.init.mode=never

# MyBatis Plus配置
mybatis-plus.mapper-locations=classpath*:/mapper/**/*.xml
mybatis-plus.type-aliases-package=com.example.demo.model.entity
mybatis-plus.configuration.map-underscore-to-camel-case=true
mybatis-plus.configuration.cache-enabled=true
mybatis-plus.configuration.lazy-loading-enabled=true
mybatis-plus.configuration.multiple-result-sets-enabled=true
mybatis-plus.configuration.use-column-label=true
mybatis-plus.configuration.auto-mapping-behavior=partial

# 外部API配置
external.organization.api.url=${EXTERNAL_ORG_API_URL:https://prod-api-server/api/organizations}
external.organization.sync.enabled=${EXTERNAL_ORG_SYNC_ENABLED:true}

# 用户同步配置
external.user.api.url=${EXTERNAL_USER_API_URL:https://prod-api-server/api/users}
external.user.sync.enabled=${EXTERNAL_USER_SYNC_ENABLED:true}

# AI模型API配置
ai.model.api.ip=${AI_MODEL_IP:prod-ai-server}
ai.model.api.port=${AI_MODEL_PORT:8000}

# 安全配置
server.error.include-stacktrace=never
server.error.include-message=never

# 监控配置
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.metrics.export.prometheus.enabled=true

# 心跳服务高性能配置
heartbeat.timeout.minutes=5
heartbeat.offline.check.interval=120000
heartbeat.cache.ttl.minutes=30
heartbeat.max.concurrent.requests=2000
heartbeat.async.pool.core-size=20
heartbeat.async.pool.max-size=50
heartbeat.async.pool.queue-capacity=1000

# 数据库优化配置
mybatis-plus.configuration.default-fetch-size=1000
mybatis-plus.configuration.default-statement-timeout=30
mybatis-plus.global-config.db-config.logic-delete-value=1
mybatis-plus.global-config.db-config.logic-not-delete-value=0